---
layout: default
title: {{ site.name }}
---

<section class="main-content">
      <p><code class="highlighter-rouge">verdaccio</code> is a fork of <code class="highlighter-rouge">sinopia</code>. It aims to keep backwards compatibility with <code class="highlighter-rouge">sinopia</code>, while keeping up with npm changes.</p>

<p><code class="highlighter-rouge">verdaccio</code> - a private/caching npm repository server</p>

<p><a href="https://travis-ci.org/verdaccio/verdaccio"><img src="http://img.shields.io/travis/verdaccio/verdaccio.svg" alt="travis badge"></a></p>

<p>It allows you to have a local npm registry with zero configuration. You don’t have to install and replicate an entire CouchDB database. Verdaccio keeps its own small database and, if a package doesn’t exist there, it asks npmjs.org for it keeping only those packages you use.</p>

<p align="center"><img src="https://f.cloud.github.com/assets/999113/1795553/680177b2-6a1d-11e3-82e1-02193aa4e32e.png"></p>

<h2 id="use-cases">Use cases</h2>

<ol>
  <li>
    <p>Use private packages.</p>

    <p>If you want to use all benefits of npm package system in your company without sending all code to the public, and use your private packages just as easy as public ones.</p>

    <p>See <a href="#using-private-packages">using private packages</a> section for details.</p>
  </li>
  <li>
    <p>Cache npmjs.org registry.</p>

    <p>If you have more than one server you want to install packages on, you might want to use this to decrease latency
(presumably “slow” npmjs.org will be connected to only once per package/version) and provide limited failover (if npmjs.org is down, we might still find something useful in the cache).</p>

    <p>See <a href="#using-public-packages-from-npmjsorg">using public packages</a> section for details.</p>
  </li>
  <li>
    <p>Override public packages.</p>

    <p>If you want to use a modified version of some 3rd-party package (for example, you found a bug, but maintainer didn’t accept pull request yet), you can publish your version locally under the same name.</p>

    <p>See <a href="#override-public-packages">override public packages</a> section for details.</p>
  </li>
</ol>

<h2 id="installation">Installation</h2>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># installation and starting (application will create default</span>
<span class="c"># config in config.yaml you can edit later)</span>
<span class="gp">$ </span>npm install -g verdaccio
<span class="gp">$ </span>verdaccio

<span class="c"># npm configuration</span>
<span class="gp">$ </span>npm <span class="nb">set </span>registry http://localhost:4873/

<span class="c"># if you use HTTPS, add an appropriate CA information</span>
<span class="c"># ("null" means get CA list from OS)</span>
<span class="gp">$ </span>npm <span class="nb">set </span>ca null
</code></pre>
</div>

<p>Now you can navigate to <a href="http://localhost:4873/">http://localhost:4873/</a> where your local packages will be listed and can be searched.</p>

<h3 id="docker">Docker</h3>

<p>To use the pre-built docker image:</p>

<p><code class="highlighter-rouge">docker pull verdaccio/verdaccio</code></p>

<p>To build your own image:</p>

<p><code class="highlighter-rouge">docker build -t verdaccio .</code></p>

<p>To run the docker container:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>docker run -it --rm --name verdaccio -p 4873:4873 \
  -v /&lt;path to verdaccio directory&gt;/conf:/verdaccio/conf \
  -v /&lt;path to verdaccio directory&gt;/storage:/verdaccio/storage \
  -v /&lt;path to verdaccio directory&gt;/local_storage:/verdaccio/local_storage \
  verdaccio
</code></pre>
</div>

<h3 id="ansible">Ansible</h3>

<p>A Verdaccio playbook <a href="https://galaxy.ansible.com/030/verdaccio">is available at galaxy</a> source: https://github.com/030/ansible-verdaccio</p>

<h3 id="chef">Chef</h3>

<p>The Verdaccio Chef cookbook <a href="https://supermarket.chef.io/cookbooks/verdaccio">is available via the chef supermarket</a>. source: https://github.com/kgrubb/verdaccio-cookbook</p>

<h3 id="puppet">Puppet</h3>

<p>The original Sinopia puppet module <a href="http://forge.puppetlabs.com/saheba/sinopia">is available at puppet forge</a> source: https://github.com/saheba/puppet-sinopia</p>

<h2 id="configuration">Configuration</h2>

<p>When you start a server, it auto-creates a config file.</p>

<h2 id="adding-a-new-user">Adding a new user</h2>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm adduser --registry http://localhost:4873/
</code></pre>
</div>

<p>This will prompt you for user credentials which will be saved on the Verdaccio server.</p>

<h2 id="using-private-packages">Using private packages</h2>

<p>You can add users and manage which users can access which packages.</p>

<p>It is recommended that you define a prefix for your private packages, for example “local”, so all your private things will look like this: <code class="highlighter-rouge">local-foo</code>. This way you can clearly separate public packages from private ones.</p>

<h2 id="using-public-packages-from-npmjsorg">Using public packages from npmjs.org</h2>

<p>If some package doesn’t exist in the storage, server will try to fetch it from npmjs.org. If npmjs.org is down, it serves packages from cache pretending that no other packages exist. Verdaccio will download only what’s needed (= requested by clients), and this information will be cached, so if client will ask the same thing second time, it can be served without asking npmjs.org for it.</p>

<p>Example: if you successfully request express@3.0.1 from this server once, you’ll able to do that again (with all it’s dependencies) anytime even if npmjs.org is down. But say express@3.0.0 will not be downloaded until it’s actually needed by somebody. And if npmjs.org is offline, this server would say that only express@3.0.1 (= only what’s in the cache) is published, but nothing else.</p>

<h2 id="override-public-packages">Override public packages</h2>

<p>If you want to use a modified version of some public package <code class="highlighter-rouge">foo</code>, you can just publish it to your local server, so when your type <code class="highlighter-rouge">npm install foo</code>, it’ll consider installing your version.</p>

<p>There’s two options here:</p>

<ol>
  <li>
    <p>You want to create a separate fork and stop synchronizing with public version.</p>

    <p>If you want to do that, you should modify your configuration file so verdaccio won’t make requests regarding this package to npmjs anymore. Add a separate entry for this package to <em>config.yaml</em> and remove <code class="highlighter-rouge">npmjs</code> from <code class="highlighter-rouge">proxy</code> list and restart the server.</p>

    <p>When you publish your package locally, you should probably start with version string higher than existing one, so it won’t conflict with existing package in the cache.</p>
  </li>
  <li>
    <p>You want to temporarily use your version, but return to public one as soon as it’s updated.</p>

    <p>In order to avoid version conflicts, you should use a custom pre-release suffix of the next patch version. For example, if a public package has version 0.1.2, you can upload 0.1.3-my-temp-fix. This way your package will be used until its original maintainer updates his public package to 0.1.3.</p>
  </li>
</ol>

<h2 id="compatibility">Compatibility</h2>

<p>Verdaccio aims to support all features of a standard npm client that make sense to support in private repository. Unfortunately, it isn’t always possible.</p>

<p>Basic features:</p>

<ul>
  <li>Installing packages (npm install, npm upgrade, etc.) - supported</li>
  <li>Publishing packages (npm publish) - supported</li>
</ul>

<p>Advanced package control:</p>

<ul>
  <li>Unpublishing packages (npm unpublish) - supported</li>
  <li>Tagging (npm tag) - not yet supported, should be soon</li>
  <li>Deprecation (npm deprecate) - not supported</li>
</ul>

<p>User management:</p>

<ul>
  <li>Registering new users (npm adduser {newuser}) - supported</li>
  <li>Transferring ownership (npm owner add {user} {pkg}) - not supported, verdaccio uses its own acl management system</li>
</ul>

<p>Misc stuff:</p>

<ul>
  <li>Searching (npm search) - supported in the browser client but not command line</li>
  <li>Starring (npm star, npm unstar) - not supported, doesn’t make sense in private registry</li>
</ul>

<h2 id="storage">Storage</h2>

<p>No CouchDB here. This application is supposed to work with zero configuration, so filesystem is used as a storage.</p>

<p>If you want to use a database instead, ask for it, we’ll come up with some kind of a plugin system.</p>

<h2 id="similar-existing-things">Similar existing things</h2>

<ul>
  <li>npm + git (I mean, using git+ssh:// dependencies) - most people seem to use this, but it’s a terrible idea… <em>npm update</em> doesn’t work, can’t use git subdirectories this way, etc.</li>
  <li><a href="https://github.com/mbrevoort/node-reggie">reggie</a> - this looks very interesting indeed… I might borrow some code there.</li>
  <li><a href="https://github.com/dominictarr/shadow-npm">shadow-npm</a>, <a href="http://shadow-npm.net/">public service</a> - it uses the same code as npmjs.org + service is dead</li>
  <li><a href="http://www.gemfury.com/l/npm-registry">gemfury</a> and others - those are closed-source cloud services, and I’m not in a mood to trust my private code to somebody (security through obscurity yeah!)</li>
  <li>npm-registry-proxy, npm-delegate, npm-proxy - those are just proxies…</li>
  <li>Is there something else?</li>
</ul>
</section>